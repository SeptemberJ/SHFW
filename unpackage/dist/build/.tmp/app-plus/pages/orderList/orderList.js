(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/orderList/orderList"],{1383:function(t,e,a){"use strict";a("db76");var s=i(a("b0ce")),n=i(a("47c7"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(n.default))},"3ed9":function(t,e,a){},"3fe6":function(t,a,s){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=r(s("a34a")),i=s("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,a,s,n,i,r){try{var o=t[i](r),c=o.value}catch(u){return void a(u)}o.done?e(c):Promise.resolve(c).then(s,n)}function c(t){return function(){var e=this,a=arguments;return new Promise(function(s,n){var i=t.apply(e,a);function r(t){o(i,s,n,r,c,"next",t)}function c(t){o(i,s,n,r,c,"throw",t)}r(void 0)})}}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},s=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),s.forEach(function(e){d(t,e,a[e])})}return t}function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var l={components:{},computed:u({},(0,i.mapState)({urlPre:function(t){return t.urlPre},userRole:function(t){return t.userRole},userId:function(t){return t.userId}})),data:function(){return{loadingText:{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},scrollLeft:0,isClickChange:!1,tabIndex:0,OrderList:[],tabBars:["待接单","待预约","上门服务","服务完成"]}},onLoad:function(){this.diffKind(this.tabIndex)},methods:{getOrderList_AZ:function(e){var a=this;t.showLoading({title:"加载中"}),t.request({url:this.urlPre+e,method:"GET",data:{id:this.userId},header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){switch(e.data.result){case 1:a.OrderList=e.data.applylist;break;default:t.showToast({image:"/static/icons/attention.png",title:"订单获取失败!"})}},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){t.hideLoading()}})},goDetail:function(e){t.navigateTo({url:"/pages/detail/detail?id="+e.currentTarget.dataset.id+"&orno="+e.currentTarget.dataset.orno})},close:function(e,a){var s=this;t.showModal({content:"是否删除本条信息？",success:function(t){t.confirm&&s.newsitems[e].data.splice(a,1)}})},loadMore:function(t){var e=this;this.newsitems[t].loadingType=1,setTimeout(function(){e.addData(t)},1200)},addData:function(t){if(this.newsitems[t].data.length>30)this.newsitems[t].loadingType=2;else{for(var e=1;e<=10;e++)this.newsitems[t].data.push(this["data"+Math.floor(5*Math.random())]);this.newsitems[t].loadingType=1}},changeTab:function(){var e=c(n.default.mark(function e(a){var s,i,r,o,c,u,d,l,f;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=a.detail.current,!this.isClickChange){e.next=6;break}return this.tabIndex=s,this.isClickChange=!1,e.abrupt("return");case 6:return e.next=8,this.getElSize("tab-bar");case 8:i=e.sent,r=i.scrollLeft,o=0,c=0;case 12:if(!(c<s)){e.next=20;break}return e.next=15,this.getElSize(this.tabBars[c].id);case 15:u=e.sent,o+=u.width;case 17:c++,e.next=12;break;case 20:return d=t.getSystemInfoSync().windowWidth,e.next=23,this.getElSize(this.tabBars[s].id);case 23:l=e.sent,f=l.width,o+f-r>d&&(this.scrollLeft=o+f-d),o<r&&(this.scrollLeft=o),this.isClickChange=!1,this.tabIndex=s;case 29:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),getElSize:function(e){return new Promise(function(a,s){t.createSelectorQuery().select("#"+e).fields({size:!0,scrollOffset:!0},function(t){a(t)}).exec()})},tapTab:function(){var t=c(n.default.mark(function t(e){return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.tabIndex!==e){t.next=4;break}return t.abrupt("return",!1);case 4:this.tabIndex=e,this.diffKind(e);case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),diffKind:function(t){switch(t){case 0:this.getOrderList_AZ("/page/selectapply.do");break;case 1:this.getOrderList_AZ("/page/daiyuyue.do");break;case 2:this.getOrderList_AZ("/page/smfw.do");break;case 3:this.getOrderList_AZ("/page/fwwc.do");break}},takeOrder:function(e){var a=this;t.showLoading({title:"加载中"}),t.request({url:this.urlPre+"/page/yuyue.do",data:{id:e.currentTarget.dataset.id,ftype:e.currentTarget.dataset.ftype},success:function(e){1==e.data.result&&(t.showToast({icon:"success",title:"接单成功!"}),a.diffKind(a.tabIndex))},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){t.hideLoading()}})},makeCall:function(e){var a=this;t.makePhoneCall({phoneNumber:e.currentTarget.dataset.tel,success:function(){console.log("成功拨打电话"),t.request({url:a.urlPre+"/page/call.do",data:{id:e.currentTarget.dataset.id,ftype:e.currentTarget.dataset.ftype},success:function(e){switch(e.data.result){case 1:a.diffKind(a.tabIndex);break;case 0:t.showToast({image:"/static/icons/attention.png",title:"订单状态修改失败!"});break;default:t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})}})},makeOrder:function(e){var a=this;t.showLoading({title:"加载中"}),t.request({url:this.urlPre+"/page/Updatetype1.do",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{id:e.currentTarget.dataset.id},success:function(e){1==e.data.result&&(t.showToast({icon:"success",title:"预约成功!"}),a.diffKind(a.tabIndex))},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){t.hideLoading()}})},scanCode:function(e){var a=this;t.request({url:this.urlPre+"/page/selectewm.do",data:{id:e.currentTarget.dataset.id,ftype:e.currentTarget.dataset.ftype,QCode:"123"},success:function(e){switch(e.data.result){case 1:t.showToast({icon:"success",title:"扫码成功!"}),a.diffKind(a.tabIndex);break;case 0:t.showToast({image:"/static/icons/attention.png",title:"订单状态修改失败!"});break;default:t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})},sign:function(e){var a=this;t.showModal({title:"提示",content:"确定进行签到",confirmText:"确定",cancelText:"取消",success:function(t){t.confirm?(console.log("sure"),a.sureSign(e.currentTarget.dataset.id)):console.log("cancel")}})},sureSign:function(a){var s=this;t.getLocation({success:function(n){t.request({url:s.urlPre+"/page/shangmen.do",data:{id:a,ftype:e.currentTarget.dataset.ftype,lat:n.latitude,lng:n.longitude},success:function(e){switch(e.data.result){case 1:t.showToast({icon:"success",title:"签到成功!"}),s.diffKind(s.tabIndex);break;case 0:t.showToast({image:"/static/icons/attention.png",title:"签到失败!"});break;default:t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})},fail:function(e){t.showToast({image:"/static/icons/attention.png",title:"定位失败!"})}})},toSubmit:function(e){t.navigateTo({url:"/pages/submit/install?id="+e.currentTarget.dataset.id+"&ftype="+e.currentTarget.dataset.ftype+"&QCode="+e.currentTarget.dataset.ewm+"&status="+e.currentTarget.dataset.status})},randomfn:function(){for(var t=[],e=0,a=this.tabBars.length;e<a;e++){for(var s={loadingType:0,data:[]},n=1;n<=10;n++)s.data.push(this["data"+Math.floor(5*Math.random())]);t.push(s)}return t}}};a.default=l}).call(this,s("649d")["default"])},"47c7":function(t,e,a){"use strict";a.r(e);var s=a("e336"),n=a("b2a0");for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);a("60b6");var r=a("2877"),o=Object(r["a"])(n["default"],s["a"],s["b"],!1,null,"74afb61f",null);e["default"]=o.exports},"60b6":function(t,e,a){"use strict";var s=a("3ed9"),n=a.n(s);n.a},b2a0:function(t,e,a){"use strict";a.r(e);var s=a("3fe6"),n=a.n(s);for(var i in s)"default"!==i&&function(t){a.d(e,t,function(){return s[t]})}(i);e["default"]=n.a},e336:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"OrderListWrap uni-tab-bar"},[a("scroll-view",{staticClass:"uni-swiper-tab",attrs:{id:"tab-bar"}},t._l(t.tabBars,function(e,s){return a("view",{key:s,class:["swiper-tab-list",t.tabIndex==s?"TabActive":""],attrs:{id:e.id,"data-current":s,eventid:"2ab1cb94-0-"+s},on:{click:function(e){t.tapTab(s)}}},[t._v(t._s(e))])})),a("view",{staticClass:"uni-list "},t._l(t.OrderList,function(e,s){return a("view",{key:s,staticClass:"uni-list-cell",attrs:{"hover-class":"uni-list-cell-hover"}},[a("view",{staticClass:"uni-media-list uni-pull-right"},[1==t.userRole?a("view",{staticClass:"uni-media-list-logo"},[2==e.fbstatus||"q"==e.fbstatus?a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-1-"+s},on:{click:t.takeOrder}},[t._v("接单")]):t._e(),e.ewm||3!=e.fbstatus?t._e():a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-2-"+s},on:{click:t.scanCode}},[t._v("扫码")]),4==e.fbstatus?a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-3-"+s},on:{click:t.makeOrder}},[t._v("预约")]):t._e(),3==e.fbstatus||4==e.fbstatus?a("button",{staticClass:"MarginT_20",attrs:{"data-id":e.id,"data-ftype":e.ftype,"data-tel":e.ftel,eventid:"2ab1cb94-4-"+s},on:{click:t.makeCall}},[t._v("打电话")]):t._e(),5==e.fbstatus?a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-5-"+s},on:{click:t.sign}},[t._v("签到")]):t._e(),6==e.fbstatus||7==e.fbstatus?a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,"data-ewm":e.ewm,"data-status":e.fbstatus,eventid:"2ab1cb94-6-"+s},on:{click:t.toSubmit}},[t._v("上传")]):t._e(),7==e.fbstatus||8==e.fbstatus?a("button",{staticClass:"MarginT_20",attrs:{"data-id":e.id,"data-ftype":e.ftype}},[t._v("签退")]):t._e(),"A"==e.fbstatus?a("image",{staticClass:"FinishedImg",attrs:{src:"/static/icons/finished.png"}}):t._e()],1):t._e(),2==t.userRole?a("view",{staticClass:"uni-media-list-logo"},[0==e.psstatus||"q"==e.psstatus?a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-7-"+s},on:{click:t.takeOrder}},[t._v("接单")]):t._e(),1==e.psstatus?a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-8-"+s},on:{click:function(t){}}},[t._v("提货")]):t._e(),2==e.psstatus?a("button",{attrs:{"data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-9-"+s},on:{click:function(t){}}},[t._v("上传")]):t._e(),3==e.psstatus?a("image",{staticClass:"FinishedImg",attrs:{src:"/static/icons/finished.png"}}):t._e()],1):t._e(),a("view",{staticClass:"uni-media-list-body",attrs:{"data-id":e.id,"data-orno":e.forderno,eventid:"2ab1cb94-10-"+s},on:{click:t.goDetail}},[a("view",{staticClass:"uni-media-list-body"},[1==t.userRole?a("image",{staticClass:"diffImg",attrs:{src:"/static/icons/az.png"}}):t._e(),2==t.userRole?a("image",{staticClass:"diffImg",attrs:{src:"/static/icons/ps.png"}}):t._e(),a("text",[t._v("订单号："+t._s(e.forderno))]),a("text",[t._v("地址："+t._s(e.faddress?e.faddress:"--"))]),a("text",[t._v("联系人："+t._s(e.fpeople?e.fpeople:"--"))]),a("text",[t._v("联系电话："+t._s(e.ftel?e.ftel:"--"))]),a("text",[t._v("特别提醒："+t._s(e.special_note?e.special_note:"--"))])])])])])}))],1)},n=[];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return n})}},[["1383","common/runtime","common/vendor"]]]);