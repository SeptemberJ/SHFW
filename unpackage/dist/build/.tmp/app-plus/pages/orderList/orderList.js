(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/orderList/orderList"],{1383:function(t,e,a){"use strict";a("db76");var i=s(a("b0ce")),n=s(a("47c7"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))},"3fe6":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(a("a34a")),n=o(a("4ae6")),s=a("2f62");function o(t){return t&&t.__esModule?t:{default:t}}function c(t,e,a,i,n,s,o){try{var c=t[s](o),r=c.value}catch(u){return void a(u)}c.done?e(r):Promise.resolve(r).then(i,n)}function r(t){return function(){var e=this,a=arguments;return new Promise(function(i,n){var s=t.apply(e,a);function o(t){c(s,i,n,o,r,"next",t)}function r(t){c(s,i,n,o,r,"throw",t)}o(void 0)})}}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},i=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),i.forEach(function(e){d(t,e,a[e])})}return t}function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var l={components:{footerNav:n.default},computed:u({},(0,s.mapState)({urlPre:function(t){return t.urlPre},userRole:function(t){return t.userRole},userId:function(t){return t.userId}})),data:function(){return{loadingText:{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},scrollLeft:0,isClickChange:!1,tabIndex:0,OrderList:[],tabBars:["待接单","待预约","上门服务","服务完成"]}},onLoad:function(){this.diffKind(this.tabIndex)},onShow:function(){console.log("created------"),this.diffKind(this.tabIndex)},onPullDownRefresh:function(){var t=r(i.default.mark(function t(){return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.diffKind(this.tabIndex);case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{getOrderList_AZ:function(e){var a=this;t.showLoading({title:"加载中"}),t.request({url:this.urlPre+e,method:"GET",data:{id:this.userId,shifuid:this.userId},header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){switch(e.data.result){case 1:t.hideLoading(),a.OrderList=e.data.applylist?e.data.applylist:e.data.wangchengList;break;default:t.hideLoading(),t.showToast({image:"/static/icons/attention.png",title:"订单获取失败!"})}},fail:function(e){console.log("request fail",e),t.hideLoading(),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){t.stopPullDownRefresh()}})},goDetail:function(e){t.navigateTo({url:"/pages/detail/detail?id="+e.currentTarget.dataset.id+"&orno="+e.currentTarget.dataset.orno})},tapTab:function(){var t=r(i.default.mark(function t(e){return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.tabIndex!==e){t.next=4;break}return t.abrupt("return",!1);case 4:this.tabIndex=e,this.diffKind(e);case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),diffKind:function(t){switch(t){case 0:this.getOrderList_AZ("/page/selectapply.do");break;case 1:this.getOrderList_AZ("/page/daiyuyue.do");break;case 2:this.getOrderList_AZ("/page/smfw.do");break;case 3:this.getOrderList_AZ("/page/getWancheng.do");break}},takeOrder:function(e){var a=this;t.showLoading({title:"加载中"}),t.request({url:this.urlPre+"/page/yuyue.do",data:{id:e.currentTarget.dataset.id,ftype:e.currentTarget.dataset.ftype},success:function(e){1==e.data.result&&(t.showToast({icon:"success",title:"接单成功!"}),a.diffKind(a.tabIndex))},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){t.hideLoading()}})},makeCall:function(e){var a=this;t.makePhoneCall({phoneNumber:e.currentTarget.dataset.tel,success:function(){console.log("成功拨打电话"),t.request({url:a.urlPre+"/page/call.do",data:{id:e.currentTarget.dataset.id,ftype:e.currentTarget.dataset.ftype},success:function(e){switch(e.data.result){case 1:a.diffKind(a.tabIndex);break;case 0:t.showToast({image:"/static/icons/attention.png",title:"订单状态修改失败!"});break;default:t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})}})},makeOrder:function(e){var a=this;t.showLoading({title:"加载中"}),t.request({url:this.urlPre+"/page/Updatetype1.do",method:"GET",header:{"content-type":"application/x-www-form-urlencoded"},data:{id:e.currentTarget.dataset.id},success:function(e){1==e.data.result&&(t.showToast({icon:"success",title:"预约成功!"}),a.diffKind(a.tabIndex))},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})},scanCode:function(e){var a=this;t.scanCode({onlyFromCamera:!0,success:function(i){t.request({url:a.urlPre+"/page/selectewm.do",data:{id:e.currentTarget.dataset.id,ftype:e.currentTarget.dataset.ftype,QCode:i.result},success:function(e){switch(e.data.result){case 1:t.showToast({icon:"success",title:"扫码成功!"}),a.diffKind(a.tabIndex);break;case 0:t.showToast({image:"/static/icons/attention.png",title:"订单状态修改失败!"});break;default:t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})}})},sign:function(e){var a=this;t.showModal({title:"提示",content:"确定进行签到",confirmText:"确定",cancelText:"取消",success:function(t){t.confirm?(console.log("sure"),a.sureSign(e.currentTarget.dataset.id,e.currentTarget.dataset.ftype)):console.log("cancel")}})},sureSign:function(e,a){var i=this;t.showLoading({title:"加载中"}),t.getLocation({success:function(n){t.request({url:i.urlPre+"/page/shangmen.do",data:{id:e,ftype:a,lat:n.latitude,lng:n.longitude},success:function(e){switch(e.data.result){case 1:t.showToast({icon:"success",title:"签到成功!"}),i.diffKind(i.tabIndex);break;case 0:t.hideLoading(),t.showToast({image:"/static/icons/attention.png",title:"签到失败!"});break;default:t.hideLoading(),t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.hideLoading(),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})},fail:function(e){t.showToast({image:"/static/icons/attention.png",title:"定位失败!"})}})},toSubmitAZ:function(e){t.navigateTo({url:"/pages/submit/install?id="+e.currentTarget.dataset.id+"&ftype="+e.currentTarget.dataset.ftype+"&QCode="+e.currentTarget.dataset.ewm+"&status="+e.currentTarget.dataset.status})},toSignOut:function(e){var a=this,i=e.currentTarget.dataset.id,n=e.currentTarget.dataset.ftype;t.showModal({title:"提示",content:"确定签退?",confirmText:"确定",cancelText:"取消",success:function(t){t.confirm?(console.log("sure"),a.OutSign(i,n)):console.log("cancel")}})},toSignOut2:function(e){var a=this,i=e.currentTarget.dataset.id;t.showActionSheet({itemList:["空跑","等通知","返工","完工"],success:function(t){switch(t.tapIndex){case 0:a.modalOutSign("空跑",0,i);break;case 1:a.modalOutSign("等通知",1,i);break;case 2:a.modalOutSign("返工",2,i);break;case 3:a.modalOutSign("完工",3,i);break}}})},modalOutSign:function(e,a,i){var n=this;t.showModal({title:"提示",content:"确定"+e+"?",confirmText:"确定",cancelText:"取消",success:function(t){switch(a){case 0:n.OutSign(i,"kongpao");break;case 1:n.OutSign(i,"dengtongzhi");break;case 2:n.OutSign(i,"fangong");break;case 3:n.OutSign(i,9);break}}})},OutSign:function(e,a){var i=this;t.showLoading({title:"加载中"}),t.request({url:this.urlPre+"/page/wancheng.do",data:{id:e,ftype:a},success:function(e){switch(e.data.result){case 1:t.showToast({icon:"success",title:"签退成功!"}),i.diffKind(i.tabIndex);break;case 0:t.hideLoading(),t.showToast({image:"/static/icons/attention.png",title:"签退失败!"});break;default:t.hideLoading(),t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}})},toSubmitPS:function(e){t.navigateTo({url:"/pages/submit/deliver?id="+e.currentTarget.dataset.id+"&ftype="+e.currentTarget.dataset.ftype})},DeliverOver:function(t){switch(this.tabIndex){case 0:this.SureOver("/page/pswc1.do","确认接单？",0,t.target.dataset.id);break;case 1:this.SureOver("/page/pswc1.do","确认提货？",1,t.target.dataset.id);break;case 2:this.SureOver("/page/pswc.do","确认完成？",2,t.target.dataset.id);break}},SureOver:function(e,a,i,n){var s=this;t.showModal({title:"提示",content:a,confirmText:"确定",cancelText:"取消",success:function(a){a.confirm&&(t.showLoading({title:"加载中"}),t.request({url:s.urlPre+e,data:{id:n,psstatus:i},success:function(e){switch(e.data.result){case 1:t.showToast({icon:"success",title:"操作成功!"}),s.diffKind(s.tabIndex);break;case 0:t.hideLoading(),t.showToast({image:"/static/icons/attention.png",title:"操作失败!"});break;default:t.hideLoading(),t.showToast({image:"/static/icons/attention.png",title:"服务器繁忙!"})}},fail:function(e){console.log("request fail",e),t.hideLoading(),t.showModal({content:e.errMsg,showCancel:!1})},complete:function(){}}))}})}}};e.default=l}).call(this,a("6e42")["default"])},"425c":function(t,e,a){"use strict";var i=a("e4d2"),n=a.n(i);n.a},"47c7":function(t,e,a){"use strict";a.r(e);var i=a("7a9f"),n=a("b2a0");for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a("425c");var o=a("2877"),c=Object(o["a"])(n["default"],i["a"],i["b"],!1,null,"cbbe1956",null);e["default"]=c.exports},"7a9f":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"OrderListWrap uni-tab-bar"},[a("scroll-view",{staticClass:"uni-swiper-tab",attrs:{id:"tab-bar"}},t._l(t.tabBars,function(e,i){return a("view",{key:i,class:["swiper-tab-list",t.tabIndex==i?"TabActive":""],attrs:{id:e.id,"data-current":i,eventid:"2ab1cb94-0-"+i},on:{click:function(e){t.tapTab(i)}}},[t._v(t._s(e))])})),a("view",{staticClass:"uni-list "},t._l(t.OrderList,function(e,i){return a("view",{key:i,staticClass:"uni-list-cell",attrs:{"hover-class":"uni-list-cell-hover"}},[a("view",{staticClass:"uni-media-list uni-pull-right"},[1==t.userRole||5==t.userRole?a("view",{staticClass:"uni-media-list-logo"},[2==e.fbstatus||"q"==e.fbstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-1-"+i},on:{click:t.takeOrder}},[t._v("接单")]):t._e(),4==e.fbstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-2-"+i},on:{click:t.makeOrder}},[t._v("预约")]):t._e(),3==e.fbstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,"data-tel":e.ftel,eventid:"2ab1cb94-3-"+i},on:{click:t.makeCall}},[t._v("打电话")]):t._e(),5==e.fbstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-4-"+i},on:{click:t.sign}},[t._v("签到")]):t._e(),6==e.fbstatus||7==e.fbstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,"data-ewm":e.ewm,"data-status":e.fbstatus,eventid:"2ab1cb94-5-"+i},on:{click:t.toSubmitAZ}},[t._v("上传")]):t._e(),7==e.fbstatus||8==e.fbstatus?a("button",{staticClass:"MarginT_20",attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-6-"+i},on:{click:t.toSignOut}},[t._v("签退")]):t._e(),"A"==e.fbstatus?a("image",{staticClass:"FinishedImg",attrs:{src:"/static/icons/finished.png"}}):t._e()],1):t._e(),2==t.userRole?a("view",{staticClass:"uni-media-list-logo"},[0==e.psstatus||"q"==e.psstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-7-"+i},on:{click:t.DeliverOver}},[t._v("接单")]):t._e(),1==e.psstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-8-"+i},on:{click:t.DeliverOver}},[t._v("提货")]):t._e(),2==e.psstatus?a("button",{attrs:{size:"mini","data-id":e.id,"data-ftype":e.ftype,eventid:"2ab1cb94-9-"+i},on:{click:t.toSubmitPS}},[t._v("上传")]):t._e(),3==e.psstatus?a("image",{staticClass:"FinishedImg",attrs:{src:"/static/icons/finished.png"}}):t._e()],1):t._e(),a("view",{staticClass:"uni-media-list-body",attrs:{"data-id":e.id,"data-orno":e.forderno,eventid:"2ab1cb94-10-"+i},on:{click:t.goDetail}},[a("view",{staticClass:"uni-media-list-body"},[1==e.ftype?a("image",{staticClass:"diffImg",attrs:{src:"/static/icons/az.png"}}):t._e(),0==e.ftype?a("image",{staticClass:"diffImg",attrs:{src:"/static/icons/jl.png"}}):t._e(),3==e.ftype?a("image",{staticClass:"diffImg",attrs:{src:"/static/icons/wx.png"}}):t._e(),a("text",[t._v("订单号："+t._s(e.forderno))]),a("text",[t._v("地址："+t._s(e.faddress?e.faddress:"(无)"))]),a("text",[t._v("联系人："+t._s(e.fpeople?e.fpeople:"(无)"))]),a("text",[t._v("联系电话："+t._s(e.ftel?e.ftel:"(无)"))]),a("text",[t._v("特别提醒："+t._s(e.special_note?e.special_note:"(无)"))])])])])])})),a("footerNav",{attrs:{mpcomid:"2ab1cb94-0"}})],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},b2a0:function(t,e,a){"use strict";a.r(e);var i=a("3fe6"),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e["default"]=n.a},e4d2:function(t,e,a){}},[["1383","common/runtime","common/vendor"]]]);